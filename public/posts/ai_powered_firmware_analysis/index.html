<!DOCTYPE html>
<html><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>AI supported firmware analysis - EMBA BEYOND</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="EMBA - The AI powered firmware security analyzer Why not use AI for firmware analysis? This is the idea we had since the public release of OpenAI&rsquo;s GPT-3 and GPT-4 earlier this year.
We started testing OpenAI&rsquo;s ChatGPT for different possible usage scenarios like the integration of further CVE explanation:
Additionally, we thought about a quick lookup for potential exploit code or POC’s:
It can be seen that the available information is quite limited because of the limited dataset for these types of requests." />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="http://localhost:1313/posts/ai_powered_firmware_analysis/">
  <meta property="og:site_name" content="EMBA BEYOND">
  <meta property="og:title" content="AI supported firmware analysis">
  <meta property="og:description" content="EMBA - The AI powered firmware security analyzer Why not use AI for firmware analysis? This is the idea we had since the public release of OpenAI’s GPT-3 and GPT-4 earlier this year.
We started testing OpenAI’s ChatGPT for different possible usage scenarios like the integration of further CVE explanation:
Additionally, we thought about a quick lookup for potential exploit code or POC’s:
It can be seen that the available information is quite limited because of the limited dataset for these types of requests.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-11-07T09:50:18+01:00">
    <meta property="article:modified_time" content="2023-11-07T09:50:18+01:00">
    <meta property="article:tag" content="EMBA">
    <meta property="article:tag" content="GPT">
    <meta property="article:tag" content="AI">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="AI supported firmware analysis">
  <meta name="twitter:description" content="EMBA - The AI powered firmware security analyzer Why not use AI for firmware analysis? This is the idea we had since the public release of OpenAI’s GPT-3 and GPT-4 earlier this year.
We started testing OpenAI’s ChatGPT for different possible usage scenarios like the integration of further CVE explanation:
Additionally, we thought about a quick lookup for potential exploit code or POC’s:
It can be seen that the available information is quite limited because of the limited dataset for these types of requests.">
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.2f9b5946627215dc1ae7fa5f82bfc9cfcab000329136befeea5733f21e77d68f.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="http://localhost:1313/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css"   />
	
	
	
		
		
		<link rel="stylesheet" type="text/css" href="http://localhost:1313/css/style.1c3be5204c15a2f4fb08f17a477d16e170af1aed32d486b044dbf7b6109d930c.css">
		
</head>
<body>
        <div class="content"><header>
	<a class="main" href="http://localhost:1313/"></a>
	<nav>
		
		<a href="/posts/">Blog</a>
		
		
    
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-8PK23K2LEL"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-8PK23K2LEL');
        }
      </script>
    
  


	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">AI supported firmware analysis</h1>
			<div class="meta">Posted on Nov 7, 2023</div>
		</div>
		

		<section class="body">
			<h1 id="emba---the-ai-powered-firmware-security-analyzer">EMBA - The AI powered firmware security analyzer</h1>
<p><em>Why not use AI for firmware analysis?</em> This is the idea we had since the public release of OpenAI&rsquo;s GPT-3 and GPT-4 earlier this year.</p>
<p>We started testing <a href="https://chat.openai.com">OpenAI&rsquo;s ChatGPT</a> for different possible usage scenarios like the integration of further CVE explanation:</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/16a0efa7-7f9e-4f2a-8f58-14a2114f5820" alt="image"></p>
<p>Additionally, we thought about a quick lookup for potential exploit code or POC’s:</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/1ebad598-c1b1-4f81-a351-e8748a98e877" alt="image"></p>
<p>It can be seen that the available information is quite limited because of the limited dataset for these types of requests. As we have already integrated multiple exploit databases, we dropped this idea for now. Probably/Hopefully we will come back to this in the future.</p>
<p>After some poking with <a href="https://chat.openai.com">OpenAI’s ChatGPT</a> via the Chat interface we decided to give it a try within <em>EMBA</em>. But, currently not for the explanation of CVE identifiers. During our testing we found out that GPT is quite good at highlighting possible weak spots in different scripting languages:</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/ebfe6fe2-3c51-491b-8f36-ec9d1f3bcc01" alt="image"></p>
<p>The main idea of the current GPT integration into EMBA is to use AI mechanisms to give the tester a better understanding of interesting areas inside the firmware. Where should he spend his time on manual investigation? To optimize the pentesters time, we already have a lot of different mechanisms integrated into <em>EMBA</em>. The AI integration is another valuable source of information for optimizing this task and pointing <em>YOU</em> to the next <strong>0day</strong> vulnerability.</p>
<h1 id="emba-chatgpt-integration">EMBA ChatGPT integration</h1>
<p>The new Q02 quest-module provides a simple way of querying the OpenAI-API with custom questions and code snippeds. The following notes give you a short overview on how to start <strong>AI-assisted firmware analysis with EMBA</strong></p>
<h2 id="configuration-step1---free">Configuration Step1 - Free</h2>
<p>Use the <code>config/gpt_config.env.template</code> file to generate the following <code>config/gpt_config.env</code> file:</p>
<ul>
<li><code>OPENAI_API_KEY=&quot;sk-XXXXXXXXXXXXXXXXXXXX&quot;</code></li>
<li><code>GPT_QUESTION=&quot;For the following code I need you to tell me how an attacker could exploit it and point out all vulnerabilities:&quot;</code></li>
<li><code>MINIMUM_GPT_PRIO=3</code>
-&gt; The <code>OPENAI_API_KEY</code> variable has to be set to be able to make API calls, the other options are for tweaking results.</li>
</ul>
<p>To generate an API key you need an OpenAI account and generate an <a href="https://platform.openai.com/account/api-keys">API-key</a></p>
<h2 id="configuration-step2-optional--requires-payment-plan-for-openai-api-currently-in-alpha-phase">Configuration Step2 (optional)- Requires Payment Plan for OpenAI-API (<em>currently in alpha phase</em>)</h2>
<ol>
<li><code>export GPT_OPTION=2</code> will enable the Module to make unrestricted API-calls</li>
<li>changing the template under <code>config/gpt_template.json</code>, for example doing:</li>
</ol>
<p><code>&quot;model&quot;: &quot;gpt-4&quot;</code></p>
<p>should enable gpt-4 functionality (only available on payment plan)</p>
<h2 id="configuration-step3---enabling-the-q02-module">Configuration Step3 - enabling the Q02-module</h2>
<p>To enable the GPT integration in the next firmware analysis process you need to activate it via setting the <em>GPT_OPTION</em> variable <code>export GPT_OPTION=&lt;1/2&gt;</code>.</p>
<p><em>Note, that to do this you need to set it for the root user!</em></p>
<p>The preferred way for enabling GPT is to setup a GPT enabled scan-profile like the example profile <code>scan-profiles/default-scan-gpt.emba</code>. This profile is optimized for GPT enabled firmware analysis.</p>
<h2 id="gpt-during-firmware-analysis">GPT during firmware analysis</h2>
<p>During the next firmware scan the API key gets automatically tested and used from <em>EMBA</em>.</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/c82f797c-fef8-4ba6-9641-b38f2da7662c" alt="image"></p>
<p>After the <em>Q container</em> is started it can be further monitored with <code>docker ps</code> and <code>docker logs</code>:</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/c230030a-5bf9-4f0c-9c37-d4fe8161342a" alt="image"></p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/0927f1f6-e594-46b1-a44a-b5f138231914" alt="image"></p>
<p>The monitoring should show the GPT requests and results during operation:</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/35d3a759-500d-4e83-8650-f4266220382a" alt="image"></p>
<p>At the end of the firmware test, the finalyzer module F05 generates the relevant linking between the already available results and the GPT results:</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/8547ab6c-27c1-4c27-a43f-3f62944e1003" alt="image"></p>
<p>The web report contains all the results that GPT provides to us:</p>
<p><img src="https://github.com/e-m-b-a/emba/assets/497520/a33ba71f-8580-412f-90f6-37938196a8c7" alt="image"></p>
<h2 id="faq">FAQ</h2>
<h3 id="q-where-do-i-get-the-needed-api-key">Q: Where do I get the needed API key?</h3>
<p>Go to <a href="https://platform.openai.com/account/api-keys">https://platform.openai.com/account/api-keys</a> and generate one.</p>
<hr>
<h3 id="q-do-i-need-to-pay-for-the-openai-account">Q: Do I need to pay for the OpenAI account?</h3>
<p>No, the default settings of EMBA are working quite good with the free account.</p>
<hr>
<h3 id="q-does-the-host-system-need-internet-access-to-query-openai-servers">Q: Does the host system need Internet access to query OpenAI servers?</h3>
<p>Yes, there is a second, purpose built docker container that needs Internet access.</p>
<hr>
<h3 id="q-im-always-running-into-the-rate-limit-handling-what-can-i-do">Q: I&rsquo;m always running into the &ldquo;Rate limit handling&rdquo;. What can I do?</h3>
<p>This issue is well known with the free OpenAI account. EMBA is trying to handle these issues as good as possible. The only real fix is a payed account.</p>
<hr>
<h3 id="q-is-the-complete-firmware-uploaded-to-openais-chatgpt">Q: Is the complete firmware uploaded to OpenAI&rsquo;s ChatGPT?</h3>
<p>No, only in case you enabled an AI-assisted scan of your firmware parts of your firmware (see also this <a href="https://github.com/e-m-b-a/emba/wiki/AI-supported-firmware-analysis#q-what-modules-have-currently-ai-assisted-support">question</a>) are uploaded and analysed via OpenAI&rsquo;s GPT solution.</p>
<hr>
<h3 id="q-what-modules-have-currently-ai-assisted-support">Q: What modules have currently AI-assisted support?</h3>
<p>Currently the following modules have AI integration:</p>
<ul>
<li>S20 - Shell analysis module</li>
<li>S21 - Python analysis module</li>
<li>S22 - PHP analysis module</li>
<li>S23 - Lua analysis module</li>
</ul>
<p>In the future more modules will be enabled.</p>
<hr>
<h3 id="q-i-have-further-ideas-for-a-better-gpt-integration-how-can-i-contact-you">Q: I have further ideas for a better GPT integration. How can I contact you?</h3>
<p>The easiest way is to open an issue <a href="https://github.com/e-m-b-a/emba/issues">here</a></p>
<hr>
<h3 id="q-i-found-a-bug-how-can-i-contact-you">Q: I found a bug. How can I contact you?</h3>
<p>The easiest way is to open an issue <a href="https://github.com/e-m-b-a/emba/issues">here</a></p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/emba">EMBA</a></li>
					
					<li><a href="/tags/gpt">GPT</a></li>
					
					<li><a href="/tags/ai">AI</a></li>
					
				</ul>
			</nav>
			
			
		</div>
	</article>
</main>
<footer>
<hr><a class="soc" href="https://github.com/e-m-b-a" title="GitHub"><i data-feather="github"></i></a>&nbsp;<a class="soc" href="https://twitter.com/securefirmware/" title="Twitter"><i data-feather="twitter"></i></a>&nbsp;
<div class="tooltip"><a class="soc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line></svg></a>
  <span class="tooltiptext">Build with Hugo & based on Archie Theme</span>
</div>
</footer>
<script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="securefirmware" data-description="Support me on Buy me a coffee!" data-message="Thank you for visiting. You can now buy me a coffee!" data-color="#FF813F" data-position="right" data-x_margin="18" data-y_margin="18"></script>
<script>
      feather.replace()
</script></div>
    </body>
</html>
